{% extends 'usersideapp/base_sidebar.html' %}
{% block page_title %}健康建議{% endblock %}
{% block content %}
{% with summary=health_summary %}
<div class="welcome-box health-header">
    <div class="health-left">
        <h1>健康建議</h1>
        <p>根據你的飲食與生活型態，提供簡單易懂的小建議。</p>
        {% if summary.has_data %}
        <div class="health-metrics">
            <div class="health-metric">
                <span class="label">平均熱量</span>
                <strong>{{ summary.averages.calories }} kcal</strong>
            </div>
            <div class="health-metric">
                <span class="label">蛋白質</span>
                <strong>{{ summary.averages.protein }} g/日</strong>
            </div>
            <div class="health-metric">
                <span class="label">碳水</span>
                <strong>{{ summary.averages.carbs }} g/日</strong>
            </div>
            <div class="health-metric">
                <span class="label">脂肪</span>
                <strong>{{ summary.averages.fat }} g/日</strong>
            </div>
        </div>
        {% endif %}
    </div>
    <div class="health-right">
        <div class="health-pill">
            本週狀態：<span class="health-status-{{ summary.status_tone }}">{{ summary.status_label }}</span>
        </div>
        <div class="health-tags">
            {% if summary.tags %}
            {% for tag in summary.tags %}
            <span class="health-tag {{ tag.tone }}">{{ tag.text }}</span>
            {% endfor %}
            {% else %}
            <span class="health-tag neutral">記錄越多，建議越精準</span>
            {% endif %}
        </div>
        <p class="health-range">{{ summary.range_label }}</p>
    </div>
</div>

<div class="section-title">今日建議</div>
<div class="card-long health-today-card">
    <div class="health-today-main">
        <div class="health-today-icon">{{ summary.today_tip.icon }}</div>
        <div>
            <div class="health-today-title">{{ summary.today_tip.title }}</div>
            <div class="health-today-desc">
                {{ summary.today_tip.description }}
            </div>
        </div>
    </div>
    <ul class="health-list">
        {% if summary.today_tip.actions %}
        {% for action in summary.today_tip.actions %}
        <li>{{ action }}</li>
        {% endfor %}
        {% else %}
        <li>持續記錄飲食，系統會依據趨勢提供建議。</li>
        {% endif %}
    </ul>
</div>

<div class="section-title">飲食與營養</div>
<div class="health-grid">
    {% for section in summary.nutrition_sections %}
    <div class="card health-card">
        <div class="health-card-title">{{ section.icon }} {{ section.title }}</div>
        <p class="health-card-text">
            {{ section.body }}
        </p>
        <ul class="health-list small">
            {% for tip in section.suggestions %}
            <li>{{ tip }}</li>
            {% endfor %}
        </ul>
    </div>
    {% empty %}
    <p class="muted">目前尚無資料，開始記錄後即可看到營養分析。</p>
    {% endfor %}
</div>

<div class="section-title">生活型態小提醒</div>
<div class="card-long health-lifestyle-card">
    <ul class="health-list">
        {% for tip in summary.lifestyle_tips %}
        <li>{{ tip }}</li>
        {% empty %}
        <li>保持規律作息與足夠水分，讓身體維持最佳狀態。</li>
        {% endfor %}
    </ul>
</div>
{% endwith %}
{% endblock %}